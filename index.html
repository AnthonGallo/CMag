<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>‚ú® El Universo de Wilmagy ‚ú®</title>
  <style>
    /* RESET Y VARIABLES */
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    :root {
      --primary: #6a5acd;
      --secondary: #9370db;
      --accent: #ffd700;
      --accent2: #ff69b4;
      --accent3: #20b2aa;
      --text-light: #ffffff;
      --text-dark: #2c2c54;
      --shadow: 0 10px 30px rgba(0,0,0,0.2);
      --shadow-light: 0 5px 15px rgba(0,0,0,0.1);
      --transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      --transition-fast: all 0.2s ease;
      --border-radius: 20px;
      --container-padding: clamp(15px, 4vw, 30px);
      --section-spacing: clamp(30px, 6vw, 60px);
    }
    
    /* ESTILOS GENERALES */
    body {
      font-family: 'Arial', sans-serif;
      margin: 0;
      padding: 0;
      background: #000;
      min-height: 100vh;
      overflow-x: hidden;
      scroll-behavior: smooth;
      cursor: default;
      color: var(--text-light);
      line-height: 1.6;
    }
    
    /* FONDO DEL UNIVERSO */
    .universe-background {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
      background: radial-gradient(ellipse at center, #0a0e2a 0%, #000000 70%);
    }
    
    /* PART√çCULAS C√ìSMICAS */
    .cosmic-particles {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 1;
      overflow: hidden;
    }
    
    .particle {
      position: absolute;
      color: var(--accent);
      font-size: clamp(8px, 2vw, 12px);
      animation: float 6s ease-in-out infinite;
      opacity: 0.8;
      z-index: 1;
      text-shadow: 0 0 10px currentColor;
    }
    
    @keyframes float {
      0%, 100% { transform: translateY(100vh) rotate(0deg); opacity: 0; }
      10% { opacity: 1; }
      90% { opacity: 1; }
      100% { transform: translateY(-100px) rotate(360deg); opacity: 0; }
    }
    
    /* SISTEMA DE PANTALLAS */
    .screen {
      min-height: 100vh;
      padding: var(--container-padding);
      position: relative;
      z-index: 2;
      opacity: 0;
      transform: translateY(20px);
      transition: opacity 0.8s ease, transform 0.8s ease;
      display: none;
      overflow: hidden;
      color: var(--text-light);
      width: 100%;
    }
    
    .screen.active {
      opacity: 1;
      transform: translateY(0);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      animation: screenFadeIn 0.8s ease-out;
    }
    
    @keyframes screenFadeIn {
      0% { opacity: 0; transform: translateY(20px); }
      100% { opacity: 1; transform: translateY(0); }
    }
    
    /* PANTALLA DE BIENVENIDA */
    .welcome-screen {
      text-align: center;
      background: rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(10px);
    }
    
    .welcome-title {
      font-size: clamp(2.5rem, 8vw, 5rem);
      margin-bottom: clamp(15px, 4vw, 25px);
      text-shadow: 0 0 30px rgba(255,215,0,0.8);
      animation: titleGlow 3s ease-in-out infinite alternate;
      background: linear-gradient(45deg, #ffd700, #ff69b4, #20b2aa, #9370db);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      font-family: 'Dancing Script', cursive;
      position: relative;
      line-height: 1.2;
    }
    
    .welcome-title::after {
      content: '';
      position: absolute;
      bottom: -10px;
      left: 50%;
      transform: translateX(-50%);
      width: 100px;
      height: 3px;
      background: linear-gradient(90deg, transparent, var(--accent), transparent);
      animation: shimmer 2s infinite;
    }
    
    @keyframes titleGlow {
      0% { transform: scale(1); text-shadow: 0 0 20px rgba(255,215,0,0.5); }
      100% { transform: scale(1.05); text-shadow: 0 0 40px rgba(255,215,0,1); }
    }
    
    @keyframes shimmer {
      0%, 100% { opacity: 0.5; }
      50% { opacity: 1; }
    }
    
    .subtitle {
      font-size: clamp(1.2rem, 4vw, 2rem);
      margin-bottom: clamp(20px, 5vw, 35px);
      text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
      opacity: 0;
      animation: fadeInUp 2s ease forwards 1s;
      font-family: 'Dancing Script', cursive;
      max-width: 90%;
      line-height: 1.4;
      padding: 0 10px;
    }
    
    @keyframes fadeInUp {
      0% { opacity: 0; transform: translateY(30px); }
      100% { opacity: 1; transform: translateY(0); }
    }
    
    .start-button {
      background: linear-gradient(145deg, #ff69b4, #ffa500, #ffd700);
      color: var(--text-light);
      border: none;
      padding: clamp(12px, 3vw, 15px) clamp(30px, 5vw, 40px);
      font-size: clamp(1rem, 3vw, 1.5rem);
      font-weight: bold;
      border-radius: 50px;
      cursor: pointer;
      transition: var(--transition);
      box-shadow: var(--shadow);
      text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
      opacity: 0;
      animation: fadeInUp 2s ease forwards 2s;
      position: relative;
      overflow: hidden;
      font-family: 'Dancing Script', cursive;
      z-index: 10;
      min-width: 200px;
      max-width: 90%;
    }
    
    .start-button::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
      transition: left 0.5s;
    }
    
    .start-button:hover {
      transform: translateY(-5px) scale(1.05);
      box-shadow: 0 15px 40px rgba(255,105,180,0.6);
    }
    
    .start-button:hover::before {
      left: 100%;
    }
    
    /* PANTALLA DEL UNIVERSO MAGY - MEJORADA */
    .universe-screen {
      background: transparent;
      text-align: center;
      justify-content: center;
      padding: var(--section-spacing);
    }
    
    .universe-content {
      max-width: 900px;
      width: 95%;
      z-index: 10;
      position: relative;
      background: rgba(0, 0, 0, 0.7);
      backdrop-filter: blur(15px);
      border-radius: var(--border-radius);
      padding: clamp(25px, 5vw, 40px);
      border: 2px solid rgba(255, 215, 0, 0.3);
      margin: 0 auto;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
      overflow: hidden;
    }
    
    .universe-content::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: radial-gradient(circle at 20% 50%, rgba(255, 215, 0, 0.1) 0%, transparent 50%),
                  radial-gradient(circle at 80% 20%, rgba(255, 105, 180, 0.1) 0%, transparent 50%),
                  radial-gradient(circle at 40% 80%, rgba(32, 178, 170, 0.1) 0%, transparent 50%);
      z-index: -1;
    }
    
    .stars-background {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 1;
    }
    
    .star {
      position: absolute;
      background: white;
      width: 2px;
      height: 2px;
      border-radius: 50%;
      animation: twinkle 4s ease-in-out infinite;
    }
    
    @keyframes twinkle {
      0%, 100% { opacity: 0.3; transform: scale(1); }
      50% { opacity: 1; transform: scale(1.5); }
    }
    
    .cosmic-title {
      font-size: clamp(2rem, 6vw, 3.5rem);
      margin-bottom: clamp(25px, 5vw, 40px);
      text-shadow: 0 0 30px rgba(255,255,255,0.8);
      animation: cosmicPulse 4s ease-in-out infinite;
      font-family: 'Dancing Script', cursive;
      position: relative;
      line-height: 1.2;
      padding: 0 10px;
    }
    
    @keyframes cosmicPulse {
      0%, 100% { color: #ffffff; }
      25% { color: #ffd700; }
      50% { color: #ff69b4; }
      75% { color: #20b2aa; }
    }
    
    .universe-poem {
      background: rgba(255,255,255,0.1);
      backdrop-filter: blur(15px);
      border-radius: var(--border-radius);
      padding: clamp(20px, 4vw, 30px);
      margin: clamp(20px, 4vw, 30px) 0;
      border: 2px solid rgba(255,215,0,0.3);
      font-size: clamp(1rem, 2.5vw, 1.3rem);
      line-height: 1.7;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
      font-family: 'Dancing Script', cursive;
      transition: var(--transition);
      position: relative;
      overflow: hidden;
      text-align: center;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
    }
    
    .universe-poem::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
      transition: left 0.6s;
    }
    
    .universe-poem:hover::before {
      left: 100%;
    }
    
    .next-button {
      background: linear-gradient(145deg, #20b2aa, #2e8b57);
      color: var(--text-light);
      border: none;
      padding: clamp(12px, 2.5vw, 15px) clamp(25px, 4vw, 30px);
      font-size: clamp(1rem, 2.5vw, 1.3rem);
      font-weight: bold;
      border-radius: 30px;
      cursor: pointer;
      margin-top: clamp(20px, 4vw, 30px);
      transition: var(--transition);
      box-shadow: 0 8px 25px rgba(32,178,170,0.4);
      position: relative;
      overflow: hidden;
      font-family: 'Dancing Script', cursive;
      min-width: 220px;
      max-width: 90%;
    }
    
    .next-button::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
      transition: left 0.5s;
    }
    
    .next-button:hover {
      transform: translateY(-3px) scale(1.05);
      box-shadow: 0 12px 30px rgba(32,178,170,0.6);
    }
    
    .next-button:hover::before {
      left: 100%;
    }
    
    /* GALER√çA DE CONSTELACIONES */
    .constellation-screen {
      background: transparent;
      padding: var(--section-spacing);
      justify-content: center;
    }
    
    .constellation-title {
      text-align: center;
      font-size: clamp(1.8rem, 5vw, 3rem);
      margin-bottom: clamp(30px, 6vw, 50px);
      color: #ffd700;
      font-family: 'Dancing Script', cursive;
      text-shadow: 0 0 20px rgba(255,215,0,0.5);
      line-height: 1.2;
      padding: 0 15px;
    }
    
    .constellation-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(min(300px, 90vw), 1fr));
      gap: clamp(20px, 4vw, 30px);
      max-width: 1200px;
      width: 95%;
      margin: 0 auto clamp(30px, 6vw, 50px) auto;
    }
    
    .constellation-card {
      background: rgba(255,255,255,0.1);
      backdrop-filter: blur(20px);
      border-radius: var(--border-radius);
      padding: clamp(20px, 4vw, 30px);
      border: 2px solid rgba(255,215,0,0.3);
      transition: var(--transition);
      cursor: pointer;
      position: relative;
      overflow: hidden;
      min-height: 280px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
    }
    
    .constellation-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: radial-gradient(circle at center, rgba(255,215,0,0.1) 0%, transparent 70%);
      opacity: 0;
      transition: opacity 0.3s;
    }
    
    .constellation-card:hover {
      transform: translateY(-8px);
      box-shadow: 0 15px 35px rgba(255,215,0,0.3);
      border-color: rgba(255,215,0,0.8);
    }
    
    .constellation-card:hover::before {
      opacity: 1;
    }
    
    .constellation-icon {
      font-size: clamp(3rem, 7vw, 4rem);
      text-align: center;
      margin-bottom: clamp(15px, 3vw, 20px);
      animation: starPulse 3s ease-in-out infinite;
    }
    
    @keyframes starPulse {
      0%, 100% { transform: scale(1); filter: brightness(1); }
      50% { transform: scale(1.1); filter: brightness(1.3); }
    }
    
    .constellation-card-title {
      font-size: clamp(1.3rem, 3.5vw, 1.6rem);
      color: #ffd700;
      margin-bottom: clamp(12px, 2.5vw, 15px);
      text-align: center;
      font-family: 'Dancing Script', cursive;
      font-weight: bold;
    }
    
    .constellation-description {
      font-size: clamp(0.9rem, 2.2vw, 1.1rem);
      line-height: 1.6;
      text-align: center;
      opacity: 0.9;
    }
    
    /* FOTO - PARTE CENTRAL */
    .photo-screen {
      background: transparent;
      text-align: center;
      justify-content: center;
      padding: var(--section-spacing);
    }
    
    .photo-title {
      font-size: clamp(1.8rem, 5vw, 3rem);
      margin-bottom: clamp(25px, 5vw, 40px);
      text-shadow: 0 0 20px rgba(255,215,0,0.8);
      animation: titleShimmer 3s ease-in-out infinite;
      font-family: 'Dancing Script', cursive;
      line-height: 1.2;
      padding: 0 15px;
    }
    
    @keyframes titleShimmer {
      0%, 100% { color: #ffffff; }
      50% { color: #ffd700; }
    }
    
    .magic-photo-container {
      position: relative;
      max-width: 500px;
      width: 95%;
      margin: clamp(25px, 5vw, 40px) 0;
    }
    
    .photo-frame {
      width: 100%;
      max-width: min(400px, 80vw);
      height: min(400px, 80vw);
      border-radius: 50%;
      border: 6px solid var(--accent);
      overflow: hidden;
      position: relative;
      box-shadow: 0 0 60px rgba(255,215,0,0.7);
      animation: photoFloat 6s ease-in-out infinite;
      margin: 0 auto;
      transition: var(--transition);
    }
    
    @keyframes photoFloat {
      0%, 100% { transform: translateY(0) rotate(0deg); }
      50% { transform: translateY(-15px) rotate(3deg); }
    }
    
    .magic-photo {
      width: 100%;
      height: 100%;
      object-fit: cover;
      filter: brightness(1.1) contrast(1.1);
      transition: var(--transition);
    }
    
    .photo-frame:hover .magic-photo {
      filter: brightness(1.2) contrast(1.1) saturate(1.1);
      transform: scale(1.05);
    }
    
    .photo-sparkles {
      position: absolute;
      top: -30px;
      left: -30px;
      width: calc(100% + 60px);
      height: calc(100% + 60px);
      pointer-events: none;
    }
    
    .photo-sparkle {
      position: absolute;
      color: var(--accent);
      font-size: clamp(14px, 3vw, 18px);
      animation: sparkleOrbit 8s linear infinite;
    }
    
    @keyframes sparkleOrbit {
      0% { transform: rotate(0deg) translateX(180px) rotate(0deg); }
      100% { transform: rotate(360deg) translateX(180px) rotate(-360deg); }
    }
    
    .photo-description {
      font-size: clamp(1rem, 2.5vw, 1.3rem);
      max-width: 700px;
      width: 95%;
      margin: 0 auto;
      line-height: 1.6;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
      padding: 0 15px;
    }
    
    /* ESCRITOS ESPECIALES */
    .writings-screen {
      background: transparent;
      padding: var(--section-spacing);
      justify-content: center;
    }
    
    .writings-container {
      max-width: 1000px;
      width: 95%;
      margin: 0 auto;
    }
    
    .writings-title {
      text-align: center;
      font-size: clamp(1.8rem, 5vw, 3rem);
      margin-bottom: clamp(30px, 6vw, 50px);
      color: #ff69b4;
      font-family: 'Dancing Script', cursive;
      line-height: 1.2;
      padding: 0 15px;
    }
    
    .writing-card {
      background: rgba(255,255,255,0.1);
      border-radius: var(--border-radius);
      padding: clamp(25px, 4vw, 35px);
      margin: clamp(20px, 4vw, 30px) 0;
      box-shadow: var(--shadow);
      border-left: 5px solid #ff69b4;
      transition: var(--transition);
      position: relative;
      overflow: hidden;
      backdrop-filter: blur(10px);
    }
    
    .writing-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.5), transparent);
      transition: left 0.6s;
    }
    
    .writing-card:hover::before {
      left: 100%;
    }
    
    .writing-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 15px 30px rgba(0,0,0,0.15);
    }
    
    .writing-title {
      font-size: clamp(1.4rem, 3.5vw, 1.8rem);
      color: #ff69b4;
      margin-bottom: clamp(15px, 3vw, 20px);
      text-align: center;
      font-family: 'Dancing Script', cursive;
      font-weight: bold;
    }
    
    .writing-content {
      font-size: clamp(1rem, 2.2vw, 1.1rem);
      line-height: 1.7;
      text-align: justify;
      white-space: pre-line;
    }
    
    .poem-card {
      background: linear-gradient(145deg, rgba(255,105,180,0.1), rgba(32,178,170,0.1));
      border-left: 5px solid #20b2aa;
    }
    
    .poem-card .writing-title {
      color: #20b2aa;
    }
    
    /* RECUERDOS VIRTUALES - 4 ELEMENTOS */
    .memories-screen {
      background: transparent;
      padding: var(--section-spacing);
      display: flex;
      flex-direction: column;
      justify-content: center;
    }
    
    .memories-container {
      max-width: 1100px;
      width: 95%;
      margin: 0 auto;
    }
    
    .memories-title {
      text-align: center;
      font-size: clamp(1.8rem, 5vw, 3rem);
      margin-bottom: clamp(35px, 7vw, 60px);
      color: var(--accent);
      font-family: 'Dancing Script', cursive;
      line-height: 1.2;
      padding: 0 15px;
    }
    
    .memory-timeline {
      position: relative;
      max-width: 900px;
      margin: 0 auto;
    }
    
    .memory-timeline::before {
      content: '';
      position: absolute;
      left: 50%;
      top: 0;
      bottom: 0;
      width: 4px;
      background: linear-gradient(to bottom, var(--accent), var(--accent2), var(--accent3));
      transform: translateX(-50%);
      box-shadow: 0 0 10px var(--accent);
    }
    
    .memory-item {
      position: relative;
      margin-bottom: clamp(30px, 5vw, 50px);
      width: 45%;
      padding: clamp(20px, 3vw, 25px);
      background: rgba(255,255,255,0.1);
      border-radius: 15px;
      backdrop-filter: blur(10px);
      transition: var(--transition);
      cursor: pointer;
      box-shadow: 0 5px 15px rgba(0,0,0,0.2);
    }
    
    .memory-item:hover {
      transform: translateY(-8px);
      background: rgba(255,255,255,0.15);
      box-shadow: 0 10px 20px rgba(0,0,0,0.3);
    }
    
    .memory-item:nth-child(odd) {
      left: 0;
    }
    
    .memory-item:nth-child(even) {
      left: 55%;
    }
    
    .memory-item::before {
      content: '';
      position: absolute;
      top: 25px;
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background: var(--accent);
      box-shadow: 0 0 10px var(--accent);
      transition: var(--transition);
    }
    
    .memory-item:hover::before {
      transform: scale(1.2);
      box-shadow: 0 0 15px var(--accent);
    }
    
    .memory-item:nth-child(odd)::before {
      right: -52px;
    }
    
    .memory-item:nth-child(even)::before {
      left: -52px;
    }
    
    .memory-date {
      font-size: clamp(1.1rem, 2.8vw, 1.3rem);
      color: var(--accent);
      margin-bottom: clamp(10px, 2vw, 12px);
      font-weight: bold;
      font-family: 'Dancing Script', cursive;
    }
    
    .memory-content {
      font-size: clamp(0.9rem, 2.2vw, 1.1rem);
      line-height: 1.6;
    }
    
    /* MENSAJES INTERACTIVOS */
    .messages-screen {
      background: transparent;
      padding: var(--section-spacing);
      justify-content: center;
    }
    
    .messages-title {
      text-align: center;
      font-size: clamp(1.8rem, 5vw, 3rem);
      margin-bottom: clamp(30px, 6vw, 50px);
      color: #ffd700;
      font-family: 'Dancing Script', cursive;
      line-height: 1.2;
      padding: 0 15px;
    }
    
    .message-selector {
      display: flex;
      flex-wrap: wrap;
      gap: clamp(12px, 2.5vw, 15px);
      justify-content: center;
      margin-bottom: clamp(25px, 5vw, 40px);
    }
    
    .message-button {
      background: rgba(255,255,255,0.2);
      border: 2px solid rgba(255,215,0,0.5);
      color: var(--text-light);
      padding: clamp(12px, 2.5vw, 14px) clamp(18px, 3.5vw, 22px);
      border-radius: 25px;
      cursor: pointer;
      transition: var(--transition);
      font-size: clamp(0.9rem, 2.2vw, 1rem);
      backdrop-filter: blur(10px);
      position: relative;
      overflow: hidden;
      min-width: 140px;
    }
    
    .message-button::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
      transition: left 0.5s;
    }
    
    .message-button:hover::before, .message-button.active::before {
      left: 100%;
    }
    
    .message-button:hover, .message-button.active {
      background: rgba(255,215,0,0.3);
      border-color: var(--accent);
      transform: translateY(-3px);
      box-shadow: 0 8px 20px rgba(255,215,0,0.3);
    }
    
    .message-display {
      background: rgba(255,255,255,0.1);
      backdrop-filter: blur(20px);
      border-radius: var(--border-radius);
      padding: clamp(25px, 4vw, 35px);
      min-height: 220px;
      text-align: center;
      font-size: clamp(1.1rem, 2.5vw, 1.3rem);
      line-height: 1.6;
      border: 2px solid rgba(255,215,0,0.3);
      transition: var(--transition);
      width: 95%;
      max-width: 800px;
      margin: 0 auto;
      position: relative;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      justify-content: center;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
    }
    
    .message-display::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
      transition: left 0.6s;
    }
    
    .message-display:hover::before {
      left: 100%;
    }
    
    /* PANTALLA FINAL */
    .final-screen {
      background: transparent;
      text-align: center;
      justify-content: center;
      padding: var(--section-spacing);
    }
    
    .final-content {
      background: rgba(255,255,255,0.1);
      backdrop-filter: blur(20px);
      border-radius: var(--border-radius);
      padding: clamp(30px, 5vw, 45px);
      max-width: 900px;
      width: 95%;
      margin: clamp(20px, 4vw, 30px) auto;
      border: 2px solid rgba(255,215,0,0.5);
      position: relative;
      overflow: hidden;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
    }
    
    .final-content::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
      transition: left 0.6s;
    }
    
    .final-content:hover::before {
      left: 100%;
    }
    
    .final-title {
      font-size: clamp(2rem, 6vw, 4rem);
      margin-bottom: clamp(20px, 4vw, 30px);
      text-shadow: 0 0 30px rgba(255,215,0,0.8);
      animation: finalGlow 3s ease-in-out infinite;
      font-family: 'Dancing Script', cursive;
      line-height: 1.2;
    }
    
    @keyframes finalGlow {
      0%, 100% { 
        transform: scale(1); 
        text-shadow: 0 0 30px rgba(255,215,0,0.8), 0 0 60px rgba(255,105,180,0.4); 
      }
      50% { 
        transform: scale(1.05); 
        text-shadow: 0 0 50px rgba(255,215,0,1), 0 0 80px rgba(255,105,180,0.6), 0 0 100px rgba(32,178,170,0.4); 
      }
    }
    
    .final-text {
      font-size: clamp(1.1rem, 2.8vw, 1.6rem);
      line-height: 1.7;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
      margin-bottom: clamp(15px, 3vw, 20px);
    }
    
    .final-highlight {
      font-size: clamp(1.3rem, 3.5vw, 2rem);
      margin: clamp(20px, 4vw, 30px) 0;
      color: var(--accent);
      text-shadow: 0 0 20px rgba(255,215,0,0.8);
      font-family: 'Dancing Script', cursive;
      font-weight: bold;
    }
    
    .final-signature {
      font-family: 'Dancing Script', cursive;
      font-size: clamp(1.6rem, 4.5vw, 2.8rem);
      margin-top: clamp(25px, 5vw, 40px);
      animation: heartbeat 2s ease-in-out infinite;
    }
    
    @keyframes heartbeat {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }
    
    /* PANTALLA: UNIVERSO REAL - MEJORADA */
    .universe-real-screen {
      background: transparent;
      text-align: center;
      overflow: hidden;
      position: relative;
      padding: 0;
    }
    
    .universe-canvas-container {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 1;
    }
    
    .universe-canvas {
      width: 100%;
      height: 100%;
      display: block;
    }
    
    .universe-title {
      position: absolute;
      top: 20px;
      left: 0;
      width: 100%;
      text-align: center;
      z-index: 3;
      font-size: clamp(2rem, 6vw, 4rem);
      color: #ffd700;
      text-shadow: 0 0 20px rgba(255,215,0,0.8);
      font-family: 'Dancing Script', cursive;
      padding: 10px 20px;
      animation: titleGlow 3s ease-in-out infinite alternate;
      background: transparent;
      backdrop-filter: none;
    }
    
    .universe-controls {
      position: absolute;
      bottom: 20px;
      left: 0;
      width: 100%;
      z-index: 3;
      display: flex;
      justify-content: center;
      gap: 15px;
    }
    
    .universe-control-button {
      background: rgba(0,0,0,0.7);
      border: 2px solid rgba(255,215,0,0.5);
      color: var(--text-light);
      padding: 10px 20px;
      border-radius: 25px;
      cursor: pointer;
      transition: var(--transition);
      font-family: 'Dancing Script', cursive;
      font-size: 1.1rem;
      backdrop-filter: blur(10px);
    }
    
    .universe-control-button:hover {
      background: rgba(255,215,0,0.3);
      transform: translateY(-3px);
    }
    
    /* BARRA DE NAVEGACI√ìN */
    .nav-toggle {
      position: fixed;
      top: clamp(15px, 3vw, 25px);
      left: clamp(15px, 3vw, 25px);
      z-index: 1001;
      background: rgba(0,0,0,0.7);
      backdrop-filter: blur(10px);
      border-radius: 50%;
      width: clamp(45px, 9vw, 60px);
      height: clamp(45px, 9vw, 60px);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      border: 2px solid rgba(255,215,0,0.5);
      transition: var(--transition);
    }
    
    .nav-toggle:hover {
      transform: scale(1.1);
      border-color: var(--accent);
      background: rgba(0,0,0,0.9);
    }
    
    .nav-toggle-icon {
      font-size: clamp(1.3rem, 3.5vw, 1.8rem);
      color: var(--accent);
      transition: var(--transition);
    }
    
    .nav-menu {
      position: fixed;
      top: 0;
      left: -320px;
      width: min(300px, 85vw);
      height: 100%;
      background: rgba(0,0,0,0.9);
      backdrop-filter: blur(20px);
      z-index: 1000;
      transition: var(--transition);
      padding: 90px 25px 25px 25px;
      box-shadow: 5px 0 15px rgba(0,0,0,0.5);
      border-right: 2px solid rgba(255,215,0,0.3);
    }
    
    .nav-menu.active {
      left: 0;
    }
    
    .nav-menu-item {
      display: block;
      width: 100%;
      padding: clamp(14px, 3vw, 18px);
      margin-bottom: 12px;
      background: rgba(255,255,255,0.1);
      border: 2px solid rgba(255,215,0,0.3);
      border-radius: 12px;
      color: var(--text-light);
      text-align: center;
      cursor: pointer;
      transition: var(--transition);
      font-family: 'Dancing Script', cursive;
      font-size: clamp(1.1rem, 2.8vw, 1.4rem);
    }
    
    .nav-menu-item:hover {
      background: rgba(255,215,0,0.2);
      transform: translateX(5px);
    }
    
    .nav-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.5);
      z-index: 999;
      opacity: 0;
      visibility: hidden;
      transition: var(--transition);
    }
    
    .nav-overlay.active {
      opacity: 1;
      visibility: visible;
    }
    
    /* CONTROL DE M√öSICA */
    .music-control {
      position: fixed;
      top: clamp(15px, 3vw, 25px);
      right: clamp(15px, 3vw, 25px);
      z-index: 1000;
      background: rgba(0,0,0,0.5);
      backdrop-filter: blur(10px);
      border-radius: 50%;
      width: clamp(40px, 8vw, 55px);
      height: clamp(40px, 8vw, 55px);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      border: 2px solid rgba(255,215,0,0.5);
      transition: var(--transition);
    }
    
    .music-control:hover {
      transform: scale(1.1);
      border-color: var(--accent);
      background: rgba(0,0,0,0.7);
    }
    
    .music-icon {
      font-size: clamp(1.1rem, 2.8vw, 1.5rem);
      color: var(--accent);
    }
    
    /* REPRODUCTOR DE SPOTIFY */
    .spotify-player {
      position: fixed;
      bottom: 20px;
      right: 20px;
      z-index: 1000;
      width: 300px;
      max-width: 90vw;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 10px 30px rgba(0,0,0,0.5);
      transition: var(--transition);
      opacity: 0.9;
    }
    
    .spotify-player:hover {
      opacity: 1;
      transform: translateY(-5px);
    }
    
    .spotify-player.minimized {
      width: 60px;
      height: 60px;
      border-radius: 50%;
    }
    
    .spotify-player.minimized iframe {
      display: none;
    }
    
    .spotify-toggle {
      position: absolute;
      top: -10px;
      right: -10px;
      width: 30px;
      height: 30px;
      background: rgba(0,0,0,0.8);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      border: 2px solid rgba(255,215,0,0.5);
      z-index: 1001;
      font-size: 14px;
      color: var(--accent);
    }
    
    /* EFECTOS ESPECIALES */
    @keyframes messageAppear {
      0% { opacity: 0; transform: translateY(10px); }
      100% { opacity: 1; transform: translateY(0); }
    }
    
    @keyframes fadeIn {
      0% { opacity: 0; }
      100% { opacity: 1; }
    }
    
    /* RESPONSIVIDAD */
    
    /* M√ìVILES PEQUE√ëOS (hasta 480px) */
    @media (max-width: 480px) {
      .screen {
        padding: 12px;
        padding-top: 70px;
        padding-bottom: 80px;
      }
      
      .photo-frame {
        height: min(280px, 75vw);
        max-width: min(280px, 75vw);
      }
      
      .memory-item {
        padding: 15px;
        width: calc(100% - 45px);
        left: 45px !important;
      }
      
      .writing-card {
        padding: 18px;
      }
      
      .message-selector {
        flex-direction: column;
        align-items: center;
      }
      
      .message-button {
        width: 100%;
        max-width: 220px;
      }
      
      .constellation-grid {
        grid-template-columns: 1fr;
        gap: 15px;
      }
      
      .nav-menu {
        width: 85vw;
        left: -85vw;
      }
      
      .universe-content, .final-content {
        padding: 20px;
      }
      
      .universe-controls {
        flex-direction: column;
        align-items: center;
        gap: 10px;
      }
      
      .spotify-player {
        width: 90vw;
        right: 5vw;
        bottom: 10px;
      }
    }
    
    /* M√ìVILES (hasta 768px) */
    @media (max-width: 768px) {
      .screen {
        padding: 15px;
        padding-top: 80px;
        padding-bottom: 90px;
        justify-content: flex-start;
      }
      
      .memory-timeline::before {
        left: 25px;
      }
      
      .memory-item {
        width: calc(100% - 55px);
        left: 55px !important;
        margin-bottom: 30px;
      }
      
      .memory-item::before {
        left: -45px !important;
      }
      
      .constellation-grid {
        grid-template-columns: 1fr;
        gap: 20px;
      }
      
      .photo-frame {
        height: min(320px, 80vw);
        max-width: min(320px, 80vw);
      }
      
      .message-selector {
        flex-direction: column;
        align-items: center;
      }
      
      .message-button {
        width: 100%;
        max-width: 240px;
      }
      
      .universe-title {
        top: 15px;
        font-size: clamp(1.6rem, 5vw, 3rem);
      }
      
      .nav-toggle {
        top: 15px;
        left: 15px;
        width: 50px;
        height: 50px;
      }
      
      .nav-toggle-icon {
        font-size: 1.4rem;
      }
      
      .nav-menu {
        width: 280px;
        left: -280px;
      }
      
      .writing-content {
        text-align: left;
        font-size: 1rem;
      }
      
      .spotify-player {
        width: 90vw;
        right: 5vw;
        bottom: 10px;
      }
    }
    
    /* TABLETS (769px a 1024px) */
    @media (min-width: 769px) and (max-width: 1024px) {
      .constellation-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 25px;
      }
      
      .memory-item {
        width: 44%;
      }
      
      .memory-item:nth-child(even) {
        left: 56%;
      }
      
      .photo-frame {
        height: min(350px, 65vw);
        max-width: min(350px, 65vw);
      }
    }
    
    /* ESCRITORIOS PEQUE√ëOS (1025px a 1200px) */
    @media (min-width: 1025px) and (max-width: 1200px) {
      .constellation-grid {
        grid-template-columns: repeat(3, 1fr);
      }
    }
    
    /* ESCRITORIOS GRANDES (m√°s de 1200px) */
    @media (min-width: 1201px) {
      .constellation-grid {
        grid-template-columns: repeat(3, 1fr);
        gap: 30px;
      }
    }
    
    /* ORIENTACI√ìN */
    @media (max-height: 500px) and (orientation: landscape) {
      .screen {
        padding-top: 80px;
        padding-bottom: 70px;
        min-height: 100vh;
      }
      
      .welcome-title {
        font-size: clamp(2rem, 6vh, 3rem);
        margin-bottom: 15px;
      }
      
      .subtitle {
        font-size: clamp(1rem, 3vh, 1.5rem);
        margin-bottom: 20px;
      }
      
      .start-button {
        padding: 10px 30px;
        font-size: 1.1rem;
      }
    }
    
    /* EFECTO DE TEXTO M√ÅGICO */
    .magic-text {
      background: linear-gradient(45deg, #ff69b4, #ffa500, #ffd700, #20b2aa, #9370db);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      background-size: 200% 200%;
      animation: gradientText 5s ease infinite;
    }
    
    @keyframes gradientText {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    
    /* ACCESIBILIDAD */
    @media (prefers-reduced-motion: reduce) {
      * {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
      }
    }
  </style>
  <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>
  <!-- FONDO DEL UNIVERSO -->
  <div class="universe-background"></div>

  <!-- PART√çCULAS C√ìSMICAS -->
  <div class="cosmic-particles"></div>

  <!-- CONTROL DE M√öSICA -->
  <div class="music-control" id="musicControl">
    <div class="music-icon">üéµ</div>
  </div>

  <!-- REPRODUCTOR DE SPOTIFY -->
  <div class="spotify-player" id="spotifyPlayer">
    <div class="spotify-toggle" id="spotifyToggle">‚àí</div>
    <iframe data-testid="embed-iframe" style="border-radius:12px" src="https://open.spotify.com/embed/track/6d8PFXIpVTRX3M0g7NIBuB?utm_source=generator" width="100%" height="352" frameBorder="0" allowfullscreen="" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy"></iframe>
  </div>

  <!-- BARRA DE NAVEGACI√ìN -->
  <div class="nav-toggle" id="navToggle">
    <div class="nav-toggle-icon">‚ò∞</div>
  </div>
  
  <div class="nav-menu" id="navMenu">
    <button class="nav-menu-item" onclick="goHome()">üè† Inicio</button>
    <button class="nav-menu-item" onclick="previousScreen()">‚Üê Anterior</button>
    <button class="nav-menu-item" onclick="nextScreen()">‚Üí Siguiente</button>
    <button class="nav-menu-item" onclick="showUniverseReal()">üåå Universo Real</button>
    <button class="nav-menu-item" onclick="toggleMusic()">üéµ M√∫sica</button>
  </div>
  
  <div class="nav-overlay" id="navOverlay"></div>

  <!-- PANTALLA DE BIENVENIDA -->
  <div id="welcomeScreen" class="screen active">
    <h1 class="welcome-title">‚ú® Para Wilmagy ‚ú®</h1>
    <p class="subtitle">Un universo completo contenido en una persona extraordinaria</p>
    <button class="start-button" onclick="showUniverse()">
      üåü Comenzar el Viaje üåü
    </button>
  </div>

  <!-- PANTALLA DEL UNIVERSO MAGY - MEJORADA -->
  <div id="universeScreen" class="screen">
    <div class="stars-background"></div>
    <div class="universe-content">
      <h1 class="cosmic-title">üåå G√©nesis de Magy üåå</h1>
      <div class="universe-poem">
        Antes del tiempo, antes del verbo primero,<br>
        solo exist√≠a el eco de tu nombre verdadero.<br>
        "Wilmagy", susurr√≥ la nada, y al pronunciar su hechizo,<br>
        un big bang de pecas doradas inici√≥ un destello.<br><br>
        
        Cada peca, una chispa, un sol reci√©n nacido,<br>
        en la piel morena del cosmos, su fuego ha encendido.<br>
        Tu cabello rojizo se expandi√≥ en la distancia,<br>
        formando nebulosas de ardiente elegancia.<br><br>
        
        Tu risa fue la fuerza que junt√≥ los planetas,<br>
        y el ritmo de tu paso orden√≥ los cometas.<br>
        Las constelaciones, que los astr√≥nomos admiran,<br>
        son solo el reflejo de las estrellas que en tus ojos miran.
      </div>
      <button class="next-button" onclick="showConstellation()">
        üåü Explorar las Constelaciones üåü
      </button>
    </div>
  </div>

  <!-- PANTALLA DE CONSTELACIONES -->
  <div id="constellationScreen" class="screen">
    <h1 class="constellation-title">‚ú® Las Constelaciones de Wilmagy ‚ú®</h1>
    
    <div class="constellation-grid">
      <div class="constellation-card">
        <div class="constellation-icon">üí™</div>
        <div class="constellation-card-title">Constelaci√≥n de la Fuerza</div>
        <div class="constellation-description">
          Como el roble inquebrantable, anclada en tierra que ha sido azotada por el viento. 
          Te paras frente a la tormenta con una entereza que deslumbrar√≠a a muchos.
        </div>
      </div>
      
      <div class="constellation-card">
        <div class="constellation-icon">üå∏</div>
        <div class="constellation-card-title">Constelaci√≥n de la Sensibilidad</div>
        <div class="constellation-description">
          Un coraz√≥n como p√©talo de cristal que capta cada susurro del mundo, 
          cada sombra, cada herida. Tu vulnerabilidad es tu humanidad m√°s pura.
        </div>
      </div>
      
      <div class="constellation-card">
        <div class="constellation-icon">üî•</div>
        <div class="constellation-card-title">Constelaci√≥n de la Sinceridad</div>
        <div class="constellation-description">
          Directa, clara como el mediod√≠a. Tu sinceridad corta cualquier falsedad 
          con la elegancia de una guerrera que no cree portar armadura.
        </div>
      </div>
      
      <div class="constellation-card">
        <div class="constellation-icon">üìö</div>
        <div class="constellation-card-title">Constelaci√≥n del Misterio</div>
        <div class="constellation-description">
          Un libro escrito en idioma antiguo y sagrado, con cap√≠tulos que prefieres 
          mantener entre par√©ntesis. Tu silencio elocuente es m√∫sica para el alma.
        </div>
      </div>
      
      <div class="constellation-card">
        <div class="constellation-icon">üåü</div>
        <div class="constellation-card-title">Constelaci√≥n de la Luz</div>
        <div class="constellation-description">
          La LUZ que no teme a la OSCURIDAD porque sabe que es en la noche 
          donde las estrellas brillan con m√°s fuerza. Eres luz pura.
        </div>
      </div>
      
      <div class="constellation-card">
        <div class="constellation-icon">üé®</div>
        <div class="constellation-card-title">Constelaci√≥n del Arte</div>
        <div class="constellation-description">
          Una obra de arte compuesta de contrastes. No a pesar de tus contradicciones, 
          sino precisamente por ellas. Eres especial, √∫nica, irrepetible.
        </div>
      </div>
    </div>
    
    <button class="next-button" onclick="showPhoto()">
      üì∏ Revelar la Esencia Visual üì∏
    </button>
  </div>

  <!-- PANTALLA DE FOTO M√ÅGICA -->
  <div id="photoScreen" class="screen">
    <h1 class="photo-title">‚ú® La Esencia del Universo ‚ú®</h1>
    
    <div class="magic-photo-container">
      <div class="photo-frame">
        <!-- FOTO -->
        <img src="https://lh3.googleusercontent.com/pw/AP1GczMTfFFt2eteZxm7qXWkKN6dy901WEXaBTOe5IHjKAu_Z-bxTVWnDZNOtbKzuvIHMX-LtgeLHh_XaOD8zNuWQkbAcXpc20mYqeRbGnTAvysixGBtf7wKeAyE-kWLe1nRqcrdfBloCWevdZA4wK52R--25A=w904-h508-s-no-gm" 
             alt="Wilmagy - La Esencia del Universo" 
             class="magic-photo">
        <div class="photo-sparkles">
          <div class="photo-sparkle" style="animation-delay: 0s;">‚ú®</div>
          <div class="photo-sparkle" style="animation-delay: 1s;">üåü</div>
          <div class="photo-sparkle" style="animation-delay: 2s;">üí´</div>
          <div class="photo-sparkle" style="animation-delay: 3s;">‚≠ê</div>
          <div class="photo-sparkle" style="animation-delay: 4s;">üå†</div>
          <div class="photo-sparkle" style="animation-delay: 5s;">‚ú®</div>
        </div>
      </div>
    </div>
    
    <div class="photo-description">
      <p>
        En cada rasgo, en cada expresi√≥n, se revela la complejidad y belleza del cosmos. 
        Eres la creadora y el mapa, la primera causa, la m√°s bella de todas las constelaciones.
        En tu rostro, el universo encuentra su raz√≥n de ser.
      </p>
    </div>
    
    <button class="next-button" onclick="showWritings()">
      üìù Mis escritos m√°s secretos üìù
    </button>
  </div>

  <!-- PANTALLA DE ESCRITOS -->
  <div id="writingsScreen" class="screen">
    <div class="writings-container">
      <h1 class="writings-title">üìú Desde lo que inspiras üìú</h1>
      
      <div class="writing-card">
        <div class="writing-title">üíù Mapa del Alma</div>
        <div class="writing-content">Magy, si las palabras tuvieran la textura del alma, tejer√≠a para ti un mapa de todo lo que eres. No es un halago, es una verdad que resuena en mi pecho cada vez que cruzas mi pensamiento.

Hay una fuerza en ti que es como el roble, fuerte e inquebrantable, anclada en una tierra que ha sido azotada por el viento. Te paras frente a la tormenta con una entereza que a muchos deslumbrar√≠a, pero que t√∫, en tu humildad, no logras ver. Esa es la primera de tus muchas paradojas: la de una guerrera que no cree portar armadura.

Y sin embargo, bajo esa fortaleza, late el coraz√≥n m√°s sensible y delicado que he conocido. Es como un p√©talo de cristal que capta cada susurro del mundo, cada sombra, cada herida pasada que se niega a cerrar. Esa debilidad que a veces maldices, esa vulnerabilidad que intentas ocultar tras un silencio elocuente o una sonrisa pronta, es precisamente lo que te hace valiosa.

Por eso te digo, con la certeza que da el haber mirado m√°s all√° de la superficie: eres incre√≠ble. Una obra de arte compuesta de contrastes. La luz que no teme a la oscuridad porque sabe que es en la noche donde las estrellas brillan con m√°s fuerza.</div>
      </div>
      
      <div class="writing-card poem-card">
        <div class="writing-title">üöÄ M√°s all√° del descubrimiento</div>
        <div class="writing-content">Al igual que Armstrong lleg√≥ a la luna,
y pis√≥ su polvo gris con paso firme,
un nuevo viaje planea mi fortuna:
llegar al mar de ti, que late y gira.

No busco conquistarte, ni dejar bandera,
mi ambici√≥n no es de gloria o de historia fr√≠a;
mi nave es de suspiros, y mi carrera
un impulso constante de poes√≠a hoy d√≠a.

√âl hall√≥ un desolado Mar de la Tranquilidad,
yo busco el oc√©ano de tu coraz√≥n,
donde la vida estalla en su totalidad
y el amor no es un fr√≠o fragmento de canci√≥n.

Porque tu coraz√≥n no es un simple astro, es un sistema completo,
con mareas de risa y tormentas de alegr√≠a sincera.
Pisar su orilla es un noble reto,
y habitarlo, la gloria eterna.

As√≠ como aquel paso fue "un peque√±o paso para un hombre",
llegar a Wilmagy, es el universo para m√≠.
El viaje verdadero, un buen plan:
no solo llegar... sino quedarme aqu√≠.</div>
      </div>
      
      <div class="writing-card">
        <div class="writing-title">üå† Al igual que el Bing Bang</div>
        <div class="writing-content">Eres constelaci√≥n de fortaleza y ternura,
un mapa estelar de rara hermosura.
Cada peca tuya es un sol reci√©n nacido,
en la piel morena del cosmos encendido.

Tu risa ordena planetas y cometas,
tu mirada ilumina nebulosas secretas.
Eres un big bang de esperanza y valor,
la creaci√≥n m√°s bella, el mejor favor.

Que el universo te devuelva en kind,
todo el amor y la luz que repartes sin fin.
Eres especial, √∫nica, sin igual,
la constelaci√≥n m√°s brillante, el mejor final.</div>
      </div>
      
      <button class="next-button" onclick="showMemories()">
        üï∞Ô∏è L√≠nea del Tiempo üï∞Ô∏è
      </button>
    </div>
  </div>

  <!-- RECUERDOS -->
  <div id="memoriesScreen" class="screen">
    <div class="memories-container">
      <h1 class="memories-title">üï∞Ô∏è L√≠nea del Tiempo Especial</h1>
      
      <div class="memory-timeline">
        <div class="memory-item">
          <div class="memory-date">Primer Encuentro</div>
          <div class="memory-content">El momento en que el universo conspir√≥ para que nuestros caminos se cruzaran, y supe que hab√≠a encontrado a alguien extraordinaria.</div>
        </div>
        
        <div class="memory-item">
          <div class="memory-date">Descubrimiento Mutuo</div>
          <div class="memory-content">Cada conversaci√≥n revelaba nuevas capas de tu ser, como deshojando una flor c√≥smica con p√©talos infinitos.</div>
        </div>
        
        <div class="memory-item">
          <div class="memory-date">Momentos Compartidos</div>
          <div class="memory-content">Risas, conversaciones profundas y esos instantes donde el tiempo parec√≠a detenerse para celebrar cada d√≠a, cada noche, esta vida...</div>
        </div>
        
        <div class="memory-item">
          <div class="memory-date">Reconocimiento</div>
          <div class="memory-content">El d√≠a que comprend√≠ la profundidad de tu ser y la fortuna que tengo de conocerte.</div>
        </div>
      </div>
      
      <button class="next-button" onclick="showMessages()">
        üíå Mensajes de mi Coraz√≥n üíå
      </button>
    </div>
  </div>

  <!-- PANTALLA DE MENSAJES INTERACTIVOS - MEJORADA -->
  <div id="messagesScreen" class="screen">
    <h1 class="messages-title">üíå Mensajes Especiales para Ti üíå</h1>
    
    <div class="message-selector">
      <button class="message-button" onclick="showMessage(0, this)">üí™ Fortaleza</button>
      <button class="message-button" onclick="showMessage(1, this)">üå∏ Ternura</button>
      <button class="message-button" onclick="showMessage(2, this)">üéØ Prop√≥sito</button>
      <button class="message-button" onclick="showMessage(3, this)">‚ú® Magia</button>
      <button class="message-button" onclick="showMessage(4, this)">üåå Universo</button>
    </div>
    
    <div class="message-display" id="messageDisplay">
      <div style="font-size: 2.5rem; margin-bottom: 20px;">üåü</div>
      <p>Selecciona un mensaje arriba para descubrir algo especial...</p>
    </div>
    
    <button class="next-button" onclick="showFinal()">
      üéâ Conclusi√≥n M√°gica üéâ
    </button>
  </div>

  <!-- PANTALLA FINAL - MEJORADA -->
  <div id="finalScreen" class="screen">
    <div class="final-content">
      <h1 class="final-title">‚ú® Desde lo m√°s profundo te digo.. ‚ú®</h1>
      
      <p class="final-text">
        No permitas que los fantasmas de ayer nublen el sol de tu hoy. 
        Llora si es necesario, pero deje que tus l√°grimas rieguen la semilla de tu propia resiliencia. 
        R√≠e con todo tu cuerpo, que tu alegr√≠a sea un himno que derrumbe cualquier muralla.
      </p>
      
      <p class="final-highlight">
        <strong>Espera todo, exige todo, mereces el universo y como t√∫, sus constelaciones.</strong>
      </p>
      
      <p class="final-text">
        Porque al final, todo esto se resume en una verdad simple y profunda que repito no por costumbre, sino por convicci√≥n:
        Eres especial. No a pesar de tus contradicciones, sino precisamente por ellas.
      </p>
      
      <div class="final-signature">
        Con cari√±o üíñ<br>
        <span style="color: #ff69b4;">Feeliz cumplea√±os Magy</span>
      </div>
    </div>
    
    <button class="next-button" onclick="showUniverseReal()">
      üåå Explorar el Universo Real üåå
    </button>
  </div>

  <!-- NUEVA PANTALLA: UNIVERSO MEJORADO -->
  <div id="universeRealScreen" class="screen universe-real-screen">
    <div class="universe-canvas-container">
      <canvas id="universeCanvas" class="universe-canvas"></canvas>
    </div>
    
    <h1 class="universe-title">‚ú® El Universo de Wilmagy ‚ú®</h1>
    
    <div class="universe-controls">
      <button class="universe-control-button" onclick="toggleOrbits()">üåå Mostrar/ocultar √≥rbitas</button>
      <button class="universe-control-button" onclick="toggleLabels()">üî§ Mostrar/ocultar nombres</button>
      <button class="universe-control-button" onclick="resetCamera()">üì∑ Reiniciar vista</button>
    </div>
  </div>

  <!-- EFECTOS DE SONIDO -->
  <audio id="clickSound" preload="auto">
    <source src="https://assets.mixkit.co/sfx/preview/mixkit-select-click-1109.mp3" type="audio/mpeg">
  </audio>
  
  <audio id="sparkleSound" preload="auto">
    <source src="https://assets.mixkit.co/sfx/preview/mixkit-magic-sparkle-sound-3091.mp3" type="audio/mpeg">
  </audio>

  <script>
    // Sistema de navegaci√≥n mejorado
    const screens = [
      'welcomeScreen', 'universeScreen', 'constellationScreen', 
      'photoScreen', 'writingsScreen', 'memoriesScreen', 
      'messagesScreen', 'finalScreen', 'universeRealScreen'
    ];
    let currentScreen = 0;
    let musicPlaying = false;
    const clickSound = document.getElementById('clickSound');
    const sparkleSound = document.getElementById('sparkleSound');
    
    // Control de navegaci√≥n
    const navToggle = document.getElementById('navToggle');
    const navMenu = document.getElementById('navMenu');
    const navOverlay = document.getElementById('navOverlay');
    
    navToggle.addEventListener('click', toggleNav);
    navOverlay.addEventListener('click', toggleNav);
    
    function toggleNav() {
      navMenu.classList.toggle('active');
      navOverlay.classList.toggle('active');
      
      // Cambiar √≠cono del bot√≥n
      const icon = navToggle.querySelector('.nav-toggle-icon');
      if (navMenu.classList.contains('active')) {
        icon.textContent = '‚úï';
      } else {
        icon.textContent = '‚ò∞';
      }
    }
    
    // Crear part√≠culas c√≥smicas mejoradas
    function createCosmicParticles() {
      const container = document.querySelector('.cosmic-particles');
      setInterval(() => {
        const particle = document.createElement('div');
        particle.classList.add('particle');
        const particles = ['‚ú®', 'üåü', 'üí´', '‚≠ê', 'üå†'];
        particle.textContent = particles[Math.floor(Math.random() * particles.length)];
        particle.style.left = Math.random() * 100 + 'vw';
        particle.style.animationDuration = (Math.random() * 3 + 3) + 's';
        particle.style.fontSize = (Math.random() * 8 + 8) + 'px';
        container.appendChild(particle);
        setTimeout(() => particle.remove(), 6000);
      }, 300);
    }
    
    createCosmicParticles();
    
    // Crear estrellas en el fondo del universo
    function createStars() {
      const starsContainer = document.querySelector('.stars-background');
      if (starsContainer) {
        starsContainer.innerHTML = '';
        for (let i = 0; i < 100; i++) {
          const star = document.createElement('div');
          star.classList.add('star');
          star.style.left = Math.random() * 100 + '%';
          star.style.top = Math.random() * 100 + '%';
          star.style.animationDelay = Math.random() * 4 + 's';
          star.style.animationDuration = (Math.random() * 3 + 2) + 's';
          starsContainer.appendChild(star);
        }
      }
    }
    
    // Control de m√∫sica con Spotify
    const spotifyPlayer = document.getElementById('spotifyPlayer');
    const spotifyToggle = document.getElementById('spotifyToggle');
    
    spotifyToggle.addEventListener('click', function(e) {
      e.stopPropagation();
      spotifyPlayer.classList.toggle('minimized');
      spotifyToggle.textContent = spotifyPlayer.classList.contains('minimized') ? '+' : '‚àí';
    });
    
    document.getElementById('musicControl').addEventListener('click', toggleMusic);
    
    function toggleMusic() {
      playSound(clickSound);
      if (musicPlaying) {
        // Pausar la m√∫sica (Spotify no permite control directo desde JS)
        spotifyPlayer.style.display = 'none';
        document.querySelector('.music-icon').textContent = 'üéµ';
      } else {
        // Reproducir m√∫sica
        spotifyPlayer.style.display = 'block';
        document.querySelector('.music-icon').textContent = 'üîä';
      }
      musicPlaying = !musicPlaying;
    }
    
    // Reproducir efectos de sonido
    function playSound(sound) {
      sound.currentTime = 0;
      sound.play().catch(e => console.log("Error reproduciendo sonido: ", e));
    }
    
    // Funciones de navegaci√≥n mejoradas
    function showScreen(screenId) {
      playSound(clickSound);
      
      // Cerrar men√∫ de navegaci√≥n si est√° abierto
      if (navMenu.classList.contains('active')) {
        toggleNav();
      }
      
      document.querySelectorAll('.screen').forEach(s => {
        s.classList.remove('active');
      });
      
      setTimeout(() => {
        document.getElementById(screenId).classList.add('active');
        currentScreen = screens.indexOf(screenId);
        
        // Efectos especiales seg√∫n la pantalla
        if (screenId === 'universeScreen') {
          setTimeout(createStars, 100);
        }
        
        if (screenId === 'photoScreen') {
          playSound(sparkleSound);
        }
        
        if (screenId === 'universeRealScreen') {
          initUniverse();
        }
        
        // Scroll suave hacia la parte superior
        window.scrollTo({ top: 0, behavior: 'smooth' });
      }, 300);
    }
    
    function showUniverse() {
      showScreen('universeScreen');
    }
    
    function showConstellation() {
      showScreen('constellationScreen');
    }
    
    function showPhoto() {
      showScreen('photoScreen');
    }
    
    function showWritings() {
      showScreen('writingsScreen');
    }
    
    function showMemories() {
      showScreen('memoriesScreen');
    }
    
    function showMessages() {
      showScreen('messagesScreen');
    }
    
    function showFinal() {
      showScreen('finalScreen');
    }
    
    function showUniverseReal() {
      showScreen('universeRealScreen');
    }
    
    function nextScreen() {
      if (currentScreen < screens.length - 1) {
        currentScreen++;
        showScreen(screens[currentScreen]);
      }
    }
    
    function previousScreen() {
      if (currentScreen > 0) {
        currentScreen--;
        showScreen(screens[currentScreen]);
      }
    }
    
    function goHome() {
      showScreen('welcomeScreen');
      currentScreen = 0;
    }
    
    function restartJourney() {
      goHome();
    }
    
    // Sistema de mensajes interactivos
    const messages = [
      {
        icon: "üí™",
        title: "Tu Fuerza Interior",
        content: "Hay una fuerza en ti que es como el roble, fuerte e inquebrantable. Te paras frente a la tormenta con una entereza que deslumbrar√≠a a muchos. Eres una guerrera, aunque no creas portar armadura."
      },
      {
        icon: "üå∏",
        title: "Tu Sensibilidad √önica",
        content: "Bajo tu fortaleza late el coraz√≥n m√°s sensible y delicado. Como un p√©talo de cristal que capta cada susurro del mundo. Esa vulnerabilidad es precisamente lo que te hace valiosa y humana."
      },
      {
        icon: "üéØ",
        title: "Tu Prop√≥sito",
        content: "Eres directa, clara como el mediod√≠a. Tu sinceridad corta cualquier falsedad. Eres un libro escrito en idioma sagrado, con cap√≠tulos enteros de sabidur√≠a que el mundo necesita descubrir."
      },
      {
        icon: "‚ú®",
        title: "La Magia que Eres",
        content: "Eres la cosmolog√≠a, el origen del sue√±o, el universo entero late en tu peque√±o centro. La creadora y el mapa, la primera causa, la m√°s bella de todas las constelaciones."
      },
      {
        icon: "üåå",
        title: "Tu Universo Interior",
        content: "Cada parte de ti es una galaxia, cada pensamiento una estrella. Eres un cosmos completo, lleno de misterios y maravillas por descubrir. El universo se refleja en tu esencia."
      }
    ];
    
    function showMessage(index, button) {
      playSound(clickSound);
      // Remover active de todos los botones
      document.querySelectorAll('.message-button').forEach(btn => btn.classList.remove('active'));
      // Agregar active al bot√≥n seleccionado
      button.classList.add('active');
      
      const message = messages[index];
      const display = document.getElementById('messageDisplay');
      
      display.style.opacity = 0;
      
      setTimeout(() => {
        display.innerHTML = `
          <div style="font-size: 3rem; margin-bottom: 20px; animation: messageAppear 0.5s ease-out;">${message.icon}</div>
          <h3 style="font-size: 1.8rem; color: #ffd700; margin-bottom: 20px; animation: messageAppear 0.5s ease-out 0.2s both;">${message.title}</h3>
          <p style="font-size: 1.3rem; line-height: 1.6; animation: messageAppear 0.5s ease-out 0.4s both;">${message.content}</p>
        `;
        
        display.style.opacity = 1;
      }, 300);
    }
    
    // Efectos de interacci√≥n adicionales
    document.querySelectorAll('.constellation-card').forEach(card => {
      card.addEventListener('click', () => {
        playSound(clickSound);
        card.style.transform = 'translateY(-5px) scale(1.02)';
        setTimeout(() => {
          card.style.transform = '';
        }, 300);
      });
    });
    
    // Efecto especial en la foto
    const photoFrame = document.querySelector('.photo-frame');
    if (photoFrame) {
      photoFrame.addEventListener('click', () => {
        playSound(sparkleSound);
        photoFrame.style.animation = 'none';
        photoFrame.style.transform = 'scale(1.05) rotate(5deg)';
        photoFrame.style.boxShadow = '0 0 60px rgba(255,215,0,0.8)';
        
        setTimeout(() => {
          photoFrame.style.transform = '';
          photoFrame.style.boxShadow = '0 0 50px rgba(255,215,0,0.6)';
          photoFrame.style.animation = 'photoFloat 6s ease-in-out infinite';
        }, 1000);
      });
    }
    
    // Efectos en la l√≠nea de tiempo
    document.querySelectorAll('.memory-item').forEach(item => {
      item.addEventListener('click', () => {
        playSound(clickSound);
        item.style.transform = 'translateY(-5px) scale(1.02)';
        setTimeout(() => {
          item.style.transform = '';
        }, 300);
      });
    });
    
    // Efectos en las tarjetas de escritos
    document.querySelectorAll('.writing-card').forEach(card => {
      card.addEventListener('click', () => {
        playSound(clickSound);
        card.style.transform = 'translateY(-3px) scale(1.01)';
        setTimeout(() => {
          card.style.transform = '';
        }, 300);
      });
    });
    
    // SISTEMA DE UNIVERSO MEJORADO
    let universeAnimationId = null;
    let universeObjects = {};
    let showOrbits = true;
    let showLabels = true;
    let cameraX = 0;
    let cameraY = 0;
    let cameraZ = 0;
    let isDragging = false;
    let lastMouseX, lastMouseY;
    
    function initUniverse() {
      if (universeAnimationId) {
        cancelAnimationFrame(universeAnimationId);
        universeAnimationId = null;
      }
      
      const canvas = document.getElementById('universeCanvas');
      const ctx = canvas.getContext('2d');
      
      // Ajustar tama√±o del canvas
      function resizeCanvas() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
      }
      
      resizeCanvas();
      window.addEventListener('resize', resizeCanvas);
      
      // Eventos de rat√≥n para rotar la c√°mara
      canvas.addEventListener('mousedown', (e) => {
        isDragging = true;
        lastMouseX = e.clientX;
        lastMouseY = e.clientY;
      });
      
      canvas.addEventListener('mousemove', (e) => {
        if (isDragging) {
          const deltaX = e.clientX - lastMouseX;
          const deltaY = e.clientY - lastMouseY;
          
          cameraX += deltaX * 0.01;
          cameraY += deltaY * 0.01;
          
          lastMouseX = e.clientX;
          lastMouseY = e.clientY;
        }
      });
      
      canvas.addEventListener('mouseup', () => {
        isDragging = false;
      });
      
      canvas.addEventListener('mouseleave', () => {
        isDragging = false;
      });
      
      // Eventos t√°ctiles para dispositivos m√≥viles
      canvas.addEventListener('touchstart', (e) => {
        if (e.touches.length === 1) {
          isDragging = true;
          lastMouseX = e.touches[0].clientX;
          lastMouseY = e.touches[0].clientY;
          e.preventDefault();
        }
      });
      
      canvas.addEventListener('touchmove', (e) => {
        if (isDragging && e.touches.length === 1) {
          const deltaX = e.touches[0].clientX - lastMouseX;
          const deltaY = e.touches[0].clientY - lastMouseY;
          
          cameraX += deltaX * 0.01;
          cameraY += deltaY * 0.01;
          
          lastMouseX = e.touches[0].clientX;
          lastMouseY = e.touches[0].clientY;
          e.preventDefault();
        }
      });
      
      canvas.addEventListener('touchend', () => {
        isDragging = false;
      });
      
      // Crear universo inicial
      createEnchantedUniverse(canvas, ctx);
      
      // Iniciar animaci√≥n
      animateUniverse(canvas, ctx);
    }
    
    function createEnchantedUniverse(canvas, ctx) {
      // Limpiar objetos anteriores
      universeObjects = {
        stars: [],
        planets: [],
        constellations: [],
        nebulae: [],
        comets: [],
        asteroids: []
      };
      
      // Crear sol (estrella central) - m√°s realista
      universeObjects.sun = {
        x: 0,
        y: 0,
        z: 0,
        radius: 70,
        color: '#FFD700',
        glow: true,
        glowColor: 'rgba(255, 215, 0, 0.4)',
        glowRadius: 180,
        pulseSpeed: 0.005,
        pulseSize: 0.1,
        surfaceDetail: []
      };
      
      // Detalles de superficie del sol
      for (let i = 0; i < 30; i++) {
        universeObjects.sun.surfaceDetail.push({
          x: Math.random() * 2 - 1,
          y: Math.random() * 2 - 1,
          size: Math.random() * 0.2 + 0.1,
          brightness: Math.random() * 0.3 + 0.7
        });
      }
      
      // Crear planetas con caracter√≠sticas m√°s realistas
      const planetData = [
        { name: 'Coraz√≥n', color: '#FF6B6B', radius: 12, distance: 120, speed: 0.0003, hasRings: false },
        { name: 'Risa', color: '#FFA07A', radius: 16, distance: 190, speed: 0.00025, hasRings: true, ringColor: '#FFB6C1' },
        { name: 'Esperanza', color: '#98FB98', radius: 20, distance: 260, speed: 0.0002, hasRings: false },
        { name: 'Fuerza', color: '#87CEEB', radius: 18, distance: 330, speed: 0.00018, hasRings: false },
        { name: 'Sue√±os', color: '#DDA0DD', radius: 22, distance: 400, speed: 0.00015, hasRings: true, ringColor: '#E6E6FA' },
        { name: 'Magia', color: '#FFD700', radius: 15, distance: 470, speed: 0.00012, hasRings: false }
      ];
      
      for (let i = 0; i < planetData.length; i++) {
        const data = planetData[i];
        
        universeObjects.planets.push({
          x: 0,
          y: 0,
          z: 0,
          radius: data.radius,
          color: data.color,
          name: data.name,
          orbitRadius: data.distance,
          angle: i * 1.2,
          speed: data.speed,
          hasRings: data.hasRings,
          ringColor: data.ringColor || '#FFFFFF',
          ringRadius: data.radius * 1.5,
          glow: true,
          glowColor: `rgba(${parseInt(data.color.slice(1,3), 16)}, ${parseInt(data.color.slice(3,5), 16)}, ${parseInt(data.color.slice(5,7), 16)}, 0.3)`,
          moons: [],
          surfaceDetail: []
        });
        
        // Agregar lunas a algunos planetas
        if (i === 1 || i === 4) { // Risa y Sue√±os tienen lunas
          const moonCount = i === 1 ? 2 : 1;
          for (let j = 0; j < moonCount; j++) {
            universeObjects.planets[i].moons.push({
              orbitRadius: data.radius * 2 + j * 15,
              angle: Math.random() * Math.PI * 2,
              speed: data.speed * 3,
              radius: data.radius * 0.4,
              color: '#F0F0F0'
            });
          }
        }
        
        // Detalles de superficie de los planetas
        for (let j = 0; j < 15; j++) {
          universeObjects.planets[i].surfaceDetail.push({
            x: Math.random() * 2 - 1,
            y: Math.random() * 2 - 1,
            size: Math.random() * 0.3 + 0.1,
            brightness: Math.random() * 0.4 + 0.6,
            color: j % 3 === 0 ? data.color : '#FFFFFF'
          });
        }
      }
      
      // Crear estrellas de fondo m√°s realistas
      for (let i = 0; i < 800; i++) {
        const distance = 500 + Math.random() * 1500;
        const angle1 = Math.random() * Math.PI * 2;
        const angle2 = Math.random() * Math.PI * 2;
        
        universeObjects.stars.push({
          x: Math.cos(angle1) * Math.cos(angle2) * distance,
          y: Math.sin(angle1) * distance,
          z: Math.cos(angle1) * Math.sin(angle2) * distance,
          size: Math.random() * 2.5 + 0.5,
          brightness: Math.random() * 0.8 + 0.2,
          twinkleSpeed: Math.random() * 0.04 + 0.01,
          twinkleOffset: Math.random() * Math.PI * 2,
          color: Math.random() > 0.7 ? 
                 (Math.random() > 0.5 ? '#FFB6C1' : '#B0E0E6') : 
                 '#FFFFFF'
        });
      }
      
      // Crear nebulosas m√°s realistas
      for (let i = 0; i < 5; i++) {
        const nebula = {
          x: (Math.random() - 0.5) * 2000,
          y: (Math.random() - 0.5) * 2000,
          z: (Math.random() - 0.5) * 2000,
          radius: Math.random() * 200 + 150,
          color: `hsla(${Math.random() * 60 + 200}, 70%, 60%, 0.03)`,
          pulseSpeed: Math.random() * 0.002 + 0.001,
          particles: [],
          shape: Math.random() > 0.5 ? 'spiral' : 'cloud'
        };
        
        // Agregar part√≠culas a la nebulosa
        for (let j = 0; j < 50; j++) {
          nebula.particles.push({
            x: (Math.random() - 0.5) * nebula.radius * 2,
            y: (Math.random() - 0.5) * nebula.radius * 2,
            z: (Math.random() - 0.5) * nebula.radius * 2,
            size: Math.random() * 3 + 1,
            speed: Math.random() * 0.3 + 0.1,
            angle: Math.random() * Math.PI * 2,
            color: `hsla(${Math.random() * 60 + 200}, 70%, 60%, ${Math.random() * 0.15 + 0.05})`
          });
        }
        
        universeObjects.nebulae.push(nebula);
      }
      
      // Crear cintur√≥n de asteroides
      for (let i = 0; i < 200; i++) {
        const distance = 350 + Math.random() * 50;
        const angle = Math.random() * Math.PI * 2;
        const height = (Math.random() - 0.5) * 40;
        
        universeObjects.asteroids.push({
          x: Math.cos(angle) * distance,
          y: height,
          z: Math.sin(angle) * distance,
          size: Math.random() * 3 + 1,
          speed: 0.0001 + Math.random() * 0.0001,
          angle: angle,
          rotation: Math.random() * Math.PI * 2,
          rotationSpeed: (Math.random() - 0.5) * 0.02,
          color: `hsl(${Math.random() * 30 + 20}, 50%, 50%)`
        });
      }
      
      // Crear cometas m√°s realistas
      for (let i = 0; i < 4; i++) {
        universeObjects.comets.push({
          x: (Math.random() - 0.5) * 2000,
          y: (Math.random() - 0.5) * 2000,
          z: (Math.random() - 0.5) * 2000,
          speedX: (Math.random() - 0.5) * 0.5,
          speedY: (Math.random() - 0.5) * 0.5,
          speedZ: (Math.random() - 0.5) * 0.5,
          size: Math.random() * 4 + 2,
          trail: [],
          maxTrail: 30,
          color: `hsl(${Math.random() * 60 + 30}, 100%, 70%)`
        });
      }
    }
    
    // Funci√≥n para proyectar un punto 3D a 2D
    function projectPoint(x, y, z, canvas) {
      const scale = 1000; // Factor de escala para la proyecci√≥n
      const distance = 1000; // Distancia de la c√°mara
      
      // Aplicar rotaci√≥n de la c√°mara
      const cosX = Math.cos(cameraX);
      const sinX = Math.sin(cameraX);
      const cosY = Math.cos(cameraY);
      const sinY = Math.sin(cameraY);
      
      // Rotar en X e Y
      let x1 = x;
      let y1 = y * cosX - z * sinX;
      let z1 = y * sinX + z * cosX;
      
      let x2 = x1 * cosY - z1 * sinY;
      let y2 = y1;
      let z2 = x1 * sinY + z1 * cosY;
      
      z2 += distance + cameraZ;
      
      // Proyecci√≥n perspectiva
      if (z2 > 0) {
        const factor = scale / z2;
        const screenX = canvas.width / 2 + x2 * factor;
        const screenY = canvas.height / 2 + y2 * factor;
        const sizeFactor = Math.max(0.1, factor);
        
        return { x: screenX, y: screenY, scale: sizeFactor, visible: true };
      }
      
      return { x: 0, y: 0, scale: 0, visible: false };
    }
    
    function animateUniverse(canvas, ctx) {
      // Limpiar canvas con un fondo espacial m√°s realista
      ctx.fillStyle = 'rgba(5, 10, 20, 0.3)';
      ctx.fillRect(0, 0, canvas.width, canvas.height);
      
      const { sun, stars, planets, nebulae, comets, asteroids } = universeObjects;
      
      // Dibujar estrellas de fondo (ordenadas por profundidad)
      const sortedStars = [...stars].sort((a, b) => {
        const aPos = projectPoint(a.x, a.y, a.z, canvas);
        const bPos = projectPoint(b.x, b.y, b.z, canvas);
        return bPos.scale - aPos.scale; // Ordenar por escala (las m√°s lejanas primero)
      });
      
      for (const star of sortedStars) {
        const pos = projectPoint(star.x, star.y, star.z, canvas);
        if (!pos.visible) continue;
        
        const twinkle = Math.sin(Date.now() * star.twinkleSpeed + star.twinkleOffset) * 0.4 + 0.6;
        const brightness = star.brightness * twinkle;
        const size = star.size * pos.scale;
        
        ctx.beginPath();
        ctx.arc(pos.x, pos.y, size, 0, Math.PI * 2);
        ctx.fillStyle = star.color.replace(')', `, ${brightness})`).replace('rgb', 'rgba');
        ctx.fill();
        
        // Efecto de brillo para estrellas grandes
        if (size > 2) {
          const gradient = ctx.createRadialGradient(
            pos.x, pos.y, 0,
            pos.x, pos.y, size * 3
          );
          gradient.addColorStop(0, star.color.replace(')', `, ${brightness * 0.4})`).replace('rgb', 'rgba'));
          gradient.addColorStop(1, 'rgba(255, 255, 255, 0)');
          
          ctx.beginPath();
          ctx.arc(pos.x, pos.y, size * 3, 0, Math.PI * 2);
          ctx.fillStyle = gradient;
          ctx.fill();
        }
      }
      
      // Dibujar nebulosas
      for (const nebula of nebulae) {
        const pos = projectPoint(nebula.x, nebula.y, nebula.z, canvas);
        if (!pos.visible) continue;
        
        const pulse = Math.sin(Date.now() * nebula.pulseSpeed) * 0.2 + 0.8;
        const radius = nebula.radius * pos.scale * pulse;
        
        if (radius > 5) { // Solo dibujar nebulosas suficientemente grandes
          ctx.beginPath();
          ctx.arc(pos.x, pos.y, radius, 0, Math.PI * 2);
          
          const gradient = ctx.createRadialGradient(
            pos.x, pos.y, 0,
            pos.x, pos.y, radius
          );
          gradient.addColorStop(0, nebula.color);
          gradient.addColorStop(1, 'rgba(5, 10, 20, 0)');
          
          ctx.fillStyle = gradient;
          ctx.fill();
          
          // Dibujar part√≠culas de la nebulosa
          for (const particle of nebula.particles) {
            const particlePos = projectPoint(
              nebula.x + particle.x, 
              nebula.y + particle.y, 
              nebula.z + particle.z, 
              canvas
            );
            
            if (particlePos.visible) {
              ctx.beginPath();
              ctx.arc(particlePos.x, particlePos.y, particle.size * particlePos.scale, 0, Math.PI * 2);
              ctx.fillStyle = particle.color;
              ctx.fill();
            }
          }
        }
      }
      
      // Actualizar y dibujar asteroides
      for (const asteroid of asteroids) {
        asteroid.angle += asteroid.speed;
        asteroid.rotation += asteroid.rotationSpeed;
        
        asteroid.x = Math.cos(asteroid.angle) * asteroid.orbitRadius;
        asteroid.z = Math.sin(asteroid.angle) * asteroid.orbitRadius;
        
        const pos = projectPoint(asteroid.x, asteroid.y, asteroid.z, canvas);
        if (pos.visible) {
          const size = asteroid.size * pos.scale;
          
          ctx.save();
          ctx.translate(pos.x, pos.y);
          ctx.rotate(asteroid.rotation);
          
          ctx.beginPath();
          ctx.arc(0, 0, size, 0, Math.PI * 2);
          ctx.fillStyle = asteroid.color;
          ctx.fill();
          
          // Detalles de la superficie del asteroide
          ctx.fillStyle = '#8B4513';
          ctx.beginPath();
          ctx.arc(-size/3, -size/3, size/3, 0, Math.PI * 2);
          ctx.fill();
          
          ctx.restore();
        }
      }
      
      // Actualizar y dibujar cometas
      for (const comet of comets) {
        // Actualizar posici√≥n
        comet.x += comet.speedX;
        comet.y += comet.speedY;
        comet.z += comet.speedZ;
        
        // Rebotar en los bordes del espacio visible
        if (Math.abs(comet.x) > 2000 || Math.abs(comet.y) > 2000 || Math.abs(comet.z) > 2000) {
          comet.x = (Math.random() - 0.5) * 1000;
          comet.y = (Math.random() - 0.5) * 1000;
          comet.z = (Math.random() - 0.5) * 1000;
          comet.trail = [];
        }
        
        // Actualizar estela
        comet.trail.unshift({x: comet.x, y: comet.y, z: comet.z});
        if (comet.trail.length > comet.maxTrail) comet.trail.pop();
        
        // Dibujar estela
        if (comet.trail.length > 1) {
          ctx.strokeStyle = comet.color;
          ctx.lineWidth = 1;
          ctx.beginPath();
          
          const firstPos = projectPoint(comet.trail[0].x, comet.trail[0].y, comet.trail[0].z, canvas);
          if (firstPos.visible) {
            ctx.moveTo(firstPos.x, firstPos.y);
            
            for (let i = 1; i < comet.trail.length; i++) {
              const pos = projectPoint(comet.trail[i].x, comet.trail[i].y, comet.trail[i].z, canvas);
              if (pos.visible) {
                ctx.lineTo(pos.x, pos.y);
              }
            }
            ctx.stroke();
          }
        }
        
        // Dibujar cabeza del cometa
        const pos = projectPoint(comet.x, comet.y, comet.z, canvas);
        if (pos.visible) {
          const size = comet.size * pos.scale;
          
          ctx.beginPath();
          ctx.arc(pos.x, pos.y, size, 0, Math.PI * 2);
          
          const gradient = ctx.createRadialGradient(
            pos.x, pos.y, 0,
            pos.x, pos.y, size * 2
          );
          gradient.addColorStop(0, '#FFFFFF');
          gradient.addColorStop(0.7, comet.color);
          gradient.addColorStop(1, 'rgba(0,0,0,0)');
          
          ctx.fillStyle = gradient;
          ctx.fill();
        }
      }
      
      // Actualizar y dibujar planetas
      for (const planet of planets) {
        // Actualizar posici√≥n del planeta
        planet.angle += planet.speed;
        planet.x = Math.cos(planet.angle) * planet.orbitRadius;
        planet.z = Math.sin(planet.angle) * planet.orbitRadius;
        
        // Efecto de pulsaci√≥n suave
        const pulse = Math.sin(Date.now() * 0.002) * 0.1 + 0.9;
        
        // Proyectar posici√≥n del planeta
        const pos = projectPoint(planet.x, planet.y, planet.z, canvas);
        if (!pos.visible) continue;
        
        const radius = planet.radius * pos.scale * pulse;
        
        // Dibujar planeta
        ctx.beginPath();
        ctx.arc(pos.x, pos.y, radius, 0, Math.PI * 2);
        
        const gradient = ctx.createRadialGradient(
          pos.x, pos.y, 0,
          pos.x, pos.y, radius
        );
        gradient.addColorStop(0, planet.color);
        gradient.addColorStop(0.7, planet.color);
        gradient.addColorStop(1, '#2F2F2F');
        
        ctx.fillStyle = gradient;
        ctx.fill();
        
        // Detalles de la superficie del planeta
        for (const detail of planet.surfaceDetail) {
          const detailX = pos.x + detail.x * radius * 0.8;
          const detailY = pos.y + detail.y * radius * 0.8;
          const detailSize = detail.size * radius * 0.3;
          
          ctx.beginPath();
          ctx.arc(detailX, detailY, detailSize, 0, Math.PI * 2);
          ctx.fillStyle = detail.color.replace(')', `, ${detail.brightness})`).replace('rgb', 'rgba');
          ctx.fill();
        }
        
        // Brillo del planeta
        if (planet.glow) {
          const glowGradient = ctx.createRadialGradient(
            pos.x, pos.y, 0,
            pos.x, pos.y, radius * 2
          );
          glowGradient.addColorStop(0, planet.glowColor);
          glowGradient.addColorStop(1, 'rgba(0,0,0,0)');
          
          ctx.beginPath();
          ctx.arc(pos.x, pos.y, radius * 2, 0, Math.PI * 2);
          ctx.fillStyle = glowGradient;
          ctx.fill();
        }
        
        // Dibujar anillos si el planeta los tiene
        if (planet.hasRings && pos.scale > 0.1) {
          ctx.strokeStyle = planet.ringColor;
          ctx.lineWidth = 2 * pos.scale;
          ctx.beginPath();
          ctx.ellipse(pos.x, pos.y, planet.ringRadius * pos.scale, planet.ringRadius * pos.scale * 0.1, planet.angle, 0, Math.PI * 2);
          ctx.stroke();
        }
        
        // Dibujar √≥rbitas si est√°n activas
        if (showOrbits) {
          ctx.strokeStyle = `rgba(255, 255, 255, 0.2)`;
          ctx.lineWidth = 1;
          ctx.beginPath();
          ctx.arc(canvas.width/2, canvas.height/2, planet.orbitRadius * pos.scale, 0, Math.PI * 2);
          ctx.stroke();
        }
        
        // Dibujar lunas
        for (const moon of planet.moons) {
          moon.angle += moon.speed;
          const moonX = planet.x + Math.cos(moon.angle) * moon.orbitRadius;
          const moonZ = planet.z + Math.sin(moon.angle) * moon.orbitRadius;
          
          const moonPos = projectPoint(moonX, planet.y, moonZ, canvas);
          if (moonPos.visible) {
            const moonRadius = moon.radius * moonPos.scale;
            
            ctx.beginPath();
            ctx.arc(moonPos.x, moonPos.y, moonRadius, 0, Math.PI * 2);
            ctx.fillStyle = moon.color;
            ctx.fill();
          }
        }
        
        // Nombre del planeta
        if (showLabels && pos.scale > 0.3) {
          ctx.font = `${12 * pos.scale}px Arial`;
          ctx.fillStyle = 'rgba(255,255,255,0.7)';
          ctx.textAlign = 'center';
          ctx.fillText(planet.name, pos.x, pos.y + radius + 15 * pos.scale);
        }
      }
      
      // Dibujar sol
      const sunPos = projectPoint(sun.x, sun.y, sun.z, canvas);
      if (sunPos.visible) {
        const sunPulse = Math.sin(Date.now() * sun.pulseSpeed) * sun.pulseSize + 1;
        const radius = sun.radius * sunPos.scale * sunPulse;
        
        // Dibujar sol con efecto de pulsaci√≥n
        ctx.beginPath();
        ctx.arc(sunPos.x, sunPos.y, radius, 0, Math.PI * 2);
        
        const sunGradient = ctx.createRadialGradient(
          sunPos.x, sunPos.y, 0,
          sunPos.x, sunPos.y, radius
        );
        sunGradient.addColorStop(0, '#FFFFFF');
        sunGradient.addColorStop(0.6, sun.color);
        sunGradient.addColorStop(1, '#FF8C00');
        
        ctx.fillStyle = sunGradient;
        ctx.fill();
        
        // Detalles de la superficie del sol
        for (const detail of sun.surfaceDetail) {
          const detailX = sunPos.x + detail.x * radius * 0.9;
          const detailY = sunPos.y + detail.y * radius * 0.9;
          const detailSize = detail.size * radius * 0.2;
          
          ctx.beginPath();
          ctx.arc(detailX, detailY, detailSize, 0, Math.PI * 2);
          ctx.fillStyle = `rgba(255, 100, 0, ${detail.brightness})`;
          ctx.fill();
        }
        
        // Dibujar brillo del sol
        if (sun.glow) {
          const glowGradient = ctx.createRadialGradient(
            sunPos.x, sunPos.y, 0,
            sunPos.x, sunPos.y, sun.glowRadius * sunPos.scale * sunPulse
          );
          glowGradient.addColorStop(0, sun.glowColor);
          glowGradient.addColorStop(1, 'rgba(255, 215, 0, 0)');
          
          ctx.beginPath();
          ctx.arc(sunPos.x, sunPos.y, sun.glowRadius * sunPos.scale * sunPulse, 0, Math.PI * 2);
          ctx.fillStyle = glowGradient;
          ctx.fill();
        }
      }
      
      universeAnimationId = requestAnimationFrame(() => animateUniverse(canvas, ctx));
    }
    
    // Funciones de control del universo
    function toggleOrbits() {
      showOrbits = !showOrbits;
    }
    
    function toggleLabels() {
      showLabels = !showLabels;
    }
    
    function resetCamera() {
      cameraX = 0;
      cameraY = 0;
      cameraZ = 0;
    }
    
    // Detener animaci√≥n cuando se cambia de pantalla
    function stopUniverseAnimation() {
      if (universeAnimationId) {
        cancelAnimationFrame(universeAnimationId);
        universeAnimationId = null;
      }
    }
    
    // Modificar la funci√≥n showScreen para detener la animaci√≥n cuando se sale del universo
    const originalShowScreen = showScreen;
    showScreen = function(screenId) {
      // Si estamos saliendo de la pantalla del universo, detener la animaci√≥n
      if (currentScreen === screens.indexOf('universeRealScreen') && screenId !== 'universeRealScreen') {
        stopUniverseAnimation();
      }
      originalShowScreen(screenId);
    };
    
    // Inicializar
    window.addEventListener('load', () => {
      setTimeout(() => {
        if (!musicPlaying) {
          // La m√∫sica se inicia autom√°ticamente a trav√©s de autoplay en el iframe
          document.querySelector('.music-icon').textContent = 'üîä';
          musicPlaying = true;
        }
      }, 2000);
    });
    
    // Eventos de teclado para navegaci√≥n
    document.addEventListener('keydown', (e) => {
      if (e.key === 'ArrowLeft') {
        previousScreen();
      } else if (e.key === 'ArrowRight') {
        nextScreen();
      } else if (e.key === 'Home' || e.key === 'Escape') {
        goHome();
      } else if (e.key === ' ') {
        toggleMusic();
      }
    });
  </script>
</body>
</html>
